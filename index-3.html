<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Module 1 Final Exam</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#f6f7f8}
  .wrap{max-width:900px;margin:auto;padding:16px}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:12px 0;box-shadow:0 1px 2px rgba(0,0,0,.04)}
  .row{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}
  .q{font-weight:700;margin:8px 0}
  .opts label{display:block;margin:6px 0;padding:8px;border:1px solid #e5e7eb;border-radius:8px}
  .short{width:100%;padding:8px;border:1px solid #e5e7eb;border-radius:8px}
  .ok{background:#dcfce7} .bad{background:#fee2e2}
  button{padding:10px 14px;border-radius:10px;border:1px solid #e5e7eb;background:#fff;cursor:pointer}
  button.primary{background:#111;color:#fff;border-color:#111}
  .timer{position:fixed;top:12px;right:12px;background:#111;color:#fff;padding:6px 12px;border-radius:999px;font-weight:700;z-index:1000}
  .muted{opacity:.75}
  em{display:block;margin-top:6px;color:#4b5563}
</style>
</head><body>
<div id="root" class="wrap"></div>
<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin></script>
<script type="text/babel" data-presets="env,react">
const {useState,useEffect}=React; const KEY='m1.final.v2';
const toL=s=>(s??'').toString().trim().toLowerCase();
const uniq=a=>Array.from(new Set(a));
const tokenize=s=>toL(s).replace(/[^\w\s]/g,' ').split(/\s+/).filter(Boolean);
const hasAll=(bag,req)=>req.every(w=>bag.has(w));
const jaccard=(a,b)=>{const A=new Set(a),B=new Set(b);const inter=[...A].filter(x=>B.has(x)).length;return inter/Math.max(1,A.size+B.size-inter)};
function gradeShort(user,rubric){const words=tokenize(user).map(w=>rubric.synonyms&&rubric.synonyms[w]||w);const bag=new Set(words);const targets=Array.isArray(rubric.keywords[0])?rubric.keywords:[rubric.keywords];let hits=0;for(const g of targets){if(hasAll(bag,g.map(toL)))hits++}const cover=hits/Math.max(1,targets.length);const sim=jaccard(words,uniq(targets.flat()));const score=Math.max(cover,sim);return score>=(rubric.minScore||0.6)}
const initialQs=[
  {type:'tf',prompt:'Standing requires a concrete injury.',choices:['True','False'],answer:'True',hint:'*Standing needs an actual, concrete stake in the outcome.*'},
  {type:'tf',prompt:'Mediation outcomes are generally binding.',choices:['True','False'],answer:'False',hint:'*Mediation helps parties agree, but the mediator does not impose a binding decision.*'},
  {type:'tf',prompt:'Appellate courts re-try cases and hear witnesses.',choices:['True','False'],answer:'False',hint:'*Appellate courts review legal errors; no new witnesses.*'},
  {type:'tf',prompt:'Federal courts have general jurisdiction over any case.',choices:['True','False'],answer:'False',hint:'*Federal jurisdiction is limited to federal questions or diversity with amount in controversy > $75,000.*'},
  {type:'tf',prompt:'Venue refers to the geographic location where a case should be heard.',choices:['True','False'],answer:'True',hint:'*Venue is the proper geographic location.*'},
  {type:'single',prompt:'What is the supreme law of the land?',choices:['Statutes','Administrative rules','Case law','Constitution'],answer:'Constitution',hint:'*All other laws must comply with it.*'},
  {type:'single',prompt:'Personal jurisdiction generally requires:',choices:['Diversity','Minimum contacts','Venue','Amount > $75,000'],answer:'Minimum contacts',hint:'*Look for the party’s ties to the forum state.*'},
  {type:'single',prompt:'Venue primarily concerns the proper:',choices:['Law','Parties','Damages','Location'],answer:'Location',hint:'*Think geography.*'},
  {type:'single',prompt:'Which ADR method is typically binding?',choices:['Negotiation','Mediation','Arbitration','Mini-trial'],answer:'Arbitration',hint:'*A neutral decides and the award is often enforceable.*'},
  {type:'single',prompt:'Who enacts statutory law?',choices:['Courts','Agencies','Legislatures','Juries'],answer:'Legislatures',hint:'*Think Congress or state assemblies.*'},
  {type:'single',prompt:'Federal court subject-matter jurisdiction covers:',choices:['Any claim over $10,000','Only state-law claims','Federal questions and qualifying diversity cases','Municipal ordinance violations'],answer:'Federal questions and qualifying diversity cases',hint:'*Two main doors: federal question or diversity + >$75,000.*'},
  {type:'single',prompt:'A motion that challenges the legal sufficiency of the complaint is:',choices:['Summary judgment','Motion to dismiss','Directed verdict','Motion in limine'],answer:'Motion to dismiss',hint:'*Filed early by the defendant.*'},
  {type:'single',prompt:'Which stage includes instructions to the jury?',choices:['Opening statements','Presentation of evidence','Jury instructions','Verdict'],answer:'Jury instructions',hint:'*Comes right before the verdict.*'},
  {type:'single',prompt:'Common law is primarily developed from:',choices:['Legislative codes','Agency manuals','Court decisions (precedent)','Executive orders'],answer:'Court decisions (precedent)',hint:'*Judge-made law built on stare decisis.*'},
  {type:'single',prompt:'A key advantage of ADR is that it is often:',choices:['Slower and more public','More formal than trial','Faster, cheaper, and more private','Only available in criminal cases'],answer:'Faster, cheaper, and more private',hint:'*ADR can preserve relationships and reduce cost/time.*'},
  {type:'short',prompt:'List the four sources of American law.',answer:{keywords:[['constitutional'],['statutory'],['administrative'],['case','common']],anyOf:4,synonyms:{common:'common',case:'case'},minScore:.7},hint:'*Constitutional, Statutory, Administrative, and Case/Common law.*'},
  {type:'short',prompt:'Name the three court prerequisites checked first (apart from standing).',answer:{keywords:[['subject','matter','jurisdiction'],['personal','jurisdiction'],['venue']],anyOf:3,synonyms:{subject:'subject',matter:'matter',jurisdiction:'jurisdiction',personal:'personal',venue:'venue'},minScore:.7},hint:'*Subject matter jurisdiction, personal jurisdiction, and venue.*'},
  {type:'short',prompt:'List the trial process stages (in order).',answer:{keywords:[['opening','statements'],['evidence','witnesses'],['closing','arguments'],['jury','instructions'],['verdict']],anyOf:5,minScore:.6},hint:'*Opening statements → Evidence & witnesses → Closing arguments → Jury instructions → Verdict.*'},
  {type:'short',prompt:'What two bases give federal courts jurisdiction?',answer:{keywords:[['federal','question'],['diversity']],anyOf:2,synonyms:{federal:'federal',question:'question',diversity:'diversity'},minScore:.7},hint:'*Federal question or diversity (with amount in controversy > $75,000).*'},
  {type:'short',prompt:'Name two advantages of ADR.',answer:{keywords:[['faster'],['cheaper','less','costly'],['confidential'],['preserve','relationships']],anyOf:2,minScore:.6},hint:'*Faster, cheaper, often confidential, and preserves relationships.*'},
];
function Timer({start,active,onEnd}){const [t,setT]=useState(start);useEffect(()=>{if(!active)return;if(t<=0){onEnd&&onEnd();return}const id=setInterval(()=>setT(s=>s-1),1000);return()=>clearInterval(id)},[active,t]);const m=Math.floor(t/60),s=t%60;return <div className="timer" aria-live="polite">{m}:{String(s).padStart(2,'0')}</div>}
function App(){
  const [started,setStarted]=useState(false);
  const [qs]=useState(initialQs);
  const saved=(()=>{try{return JSON.parse(localStorage.getItem(KEY)||'{}')}catch{return {}}})();
  const [ans,setAns]=useState(saved.ans||{});
  const [graded,setGraded]=useState(!!saved.graded);
  const [second,setSecond]=useState(saved.second||{});
  const [override,setOverride]=useState(saved.override||{});
  useEffect(()=>{localStorage.setItem(KEY,JSON.stringify({ans,graded,second,override}))},[ans,graded,second,override]);
  const setA=(i,v)=>setAns(p=>{const n={...p};n[i]=v;return n});
  const setO=(i,v)=>setOverride(p=>{const n={...p};n[i]=v;return n});
  const baseOK=(q,a)=>{if(q.type==='multi'){const A=(a||[]).map(toL).sort().join('|');const B=(q.answer||[]).map(toL).sort().join('|');return A===B} if(q.type==='short'){return gradeShort(a||'',q.answer)} return toL(a)===toL(q.answer)};
  const scoreOne=(q,a,i)=>{const o=override[i];if(o==='ok')return true;if(o==='wrong')return false;if(o==='partial')return false;return baseOK(q,a)};
  const total=qs.length;const correctCount=graded?qs.reduce((s,q,i)=>s+(scoreOne(q,ans[i],i)?1:0),0):0;
  const startExam=()=>setStarted(true);
  const onGrade=()=>setGraded(true);
  const onEnd=()=>alert('Time is up! You can still review and grade.');
  return (
    <div>
      <Timer start={3000} active={started} onEnd={onEnd}/>
      <div className="card row">
        <div><strong>Module 1 Final Exam</strong> <span className="muted">20 Q • 50 min • T/F (5), MC (10), SA (5)</span></div>
        {!started && <button className="primary" onClick={startExam}>Let's get this started</button>}
        {started && <div className="muted">Progress: {Object.values(ans).filter(v=>Array.isArray(v)?v.length:toL(v).length).length}/{total}</div>}
      </div>
      {started && qs.map((q,i)=>{const a=ans[i]??(q.type==='multi'?[]:'');const ok=graded?scoreOne(q,a,i):null;const cls=graded?(ok?'ok':'bad'):'';return (
        <div key={i} className={'card '+cls}>
          <div className="q">{i+1}. {q.prompt} <span className="muted">({q.type==='multi'?'Multiple Select':q.type==='short'?'Short Answer':q.type==='tf'?'True/False':'Multiple Choice'})</span></div>
          {q.type==='short'? (
            <div>
              <textarea className="short" rows="3" value={typeof a==='string'?a:''} onChange={e=>setA(i,e.target.value)} placeholder="Type your answer…"/>
              {graded && (baseOK(q,a)? <div className="muted">✔ AI says correct.</div> : <div><em>{q.hint}</em><div className="row" style={{marginTop:6}}><button onClick={()=>setSecond(s=>({...s,[i]:true}))}>Try again</button><span className="muted">AI marked incorrect. You can retry, then press Score again.</span></div></div>)}
              {graded && <div className="row" style={{marginTop:6}}><span className="muted">Manual override:</span><select value={override[i]||''} onChange={e=>setO(i,e.target.value)}><option value="">None</option><option value="ok">Mark Correct</option><option value="partial">Mark Partial</option><option value="wrong">Mark Incorrect</option></select></div>}
              {graded && override[i] && <div className="muted">Override: {override[i]}</div>}
            </div>
          ) : (
            <div className="opts">{q.choices.map((c,j)=>{const v=String(c);if(q.type==='multi'){const checked=(a||[]).includes(v);return <label key={`m${i}_${j}`}><input type="checkbox" checked={checked} onChange={e=>{const set=new Set(a||[]);e.target.checked?set.add(v):set.delete(v);setA(i,[...set])}}/> {v}</label>}return <label key={`s${i}_${j}`}><input type="radio" name={`q${i}`} checked={a===v} onChange={()=>setA(i,v)}/> {v}</label>})}</div>
          )}
          {graded===true && ok===false && !second[i] && q.hint && <em>{q.hint}</em>}
        </div>
      )})}
      {started && <div className="card row"><div><strong>Ready to see your score?</strong></div><button className="primary" onClick={onGrade}>Score</button>{graded && <div><strong>Score:</strong> {correctCount}/{total}</div>}</div>}
      <div className="card muted"><strong>Notes</strong><ul>
        <li>Second-chance: After scoring, incorrect answers show a hint and let you retry; click <em>Score</em> again.</li>
        <li>Short Answer uses AI-style keyword/synonym matching; you can manually override the result.</li>
        <li>Autosave: Your progress is saved locally.</li>
      </ul></div>
    </div>
  )
}
ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
// Console smoke tests
(function(){
  console.assert(gradeShort('constitutional statutory administrative case', initialQs[15].answer), 'sources SA should pass');
  console.assert(gradeShort('federal question and diversity jurisdiction', initialQs[18].answer), 'bases SA should pass');
})();
(function(){
  console.assert(gradeShort('opening statements evidence witnesses closing arguments jury instructions verdict', initialQs[17].answer), 'stages SA should pass');
  console.assert(!gradeShort('only opening statements', initialQs[17].answer), 'stages SA should fail with insufficient coverage');
  const q={type:'multi',answer:['A','C']};const A=['C','A'].map(toL).sort().join('|');const B=q.answer.map(toL).sort().join('|');console.assert(A===B,'multi compare');
})();
</script>
</body></html>
